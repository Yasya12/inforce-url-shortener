import{a as N,b as C,c as V,d as k,e as D,f as G,g as M,h as $,i as B}from"./chunk-TXVCWUOQ.js";import{a as O}from"./chunk-GL7C3NZA.js";import{h as R,j as I}from"./chunk-IOW66UP7.js";import{C as S,D as l,Ga as F,Ia as A,J as y,T as s,U as m,V as w,W as T,X as u,Y as n,Z as o,_ as b,ba as h,da as v,ea as d,ia as a,ja as _,ka as U,na as L,o as c,q as x,r as g,v as p,wa as E}from"./chunk-EW4TTHCM.js";var z=t=>["/urls",t],P=(t,i)=>i.id;function H(t,i){if(t&1){let e=h();n(0,"div",2)(1,"h3",7),a(2,"Add new URL"),o(),n(3,"form",8),v("ngSubmit",function(){x(e);let f=d();return g(f.onAddUrl())}),b(4,"input",9),n(5,"button",10),a(6," Shorten "),o()()()}if(t&2){let e=d();l(3),u("formGroup",e.addUrlForm),l(2),u("disabled",e.addUrlForm.invalid)}}function J(t,i){t&1&&(n(0,"p",4),a(1,"Loading URLs..."),o())}function K(t,i){if(t&1&&(n(0,"p",5),a(1),o()),t&2){let e=d();l(),U(" ",e.error()," ")}}function Q(t,i){if(t&1){let e=h();n(0,"button",22),v("click",function(){x(e);let f=d().$implicit,q=d(2);return g(q.onDelete(f.id))}),a(1," Delete "),o()}}function W(t,i){if(t&1&&(n(0,"tr",15)(1,"td",16)(2,"a",17),a(3),o()(),n(4,"td",18)(5,"a",19),a(6),o()(),n(7,"td",20),a(8),o(),n(9,"td",18),s(10,Q,2,0,"button",21),o()()),t&2){let e=i.$implicit,r=d(2);l(2),u("routerLink",L(7,z,e.id))("title",e.originalUrl),l(),U(" ",e.originalUrl," "),l(2),u("href",e.shortUrl,S),l(),_(e.shortUrl),l(2),_(e.createdByEmail),l(2),m(r.authService.isAuthenticated()&&(r.authService.isAdmin()||e.createdByEmail===(r.authService.user==null?null:r.authService.user.email))?10:-1)}}function X(t,i){if(t&1&&(n(0,"div",6)(1,"table",11)(2,"thead",12)(3,"tr")(4,"th",13),a(5," Original URL "),o(),n(6,"th",13),a(7," Short URL "),o(),n(8,"th",13),a(9," Created By "),o(),n(10,"th",13),a(11," Actions "),o()()(),n(12,"tbody",14),w(13,W,11,9,"tr",15,P),o()()()),t&2){let e=d();l(13),T(e.urls())}}function Y(t,i){t&1&&(n(0,"p",4),a(1," No URLs found. Add one to get started! "),o())}var j=class t{urlApiService=c(O);fb=c($);authService=c(I);toastr=c(R);urls=p([]);isLoading=p(!0);error=p(null);addUrlForm;constructor(){this.addUrlForm=this.fb.group({originalUrl:["",[C.required,C.pattern(/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i)]]})}ngOnInit(){this.loadUrls()}loadUrls(){this.isLoading.set(!0),this.urlApiService.getUrls().subscribe({next:i=>{this.urls.set(i),this.isLoading.set(!1)},error:i=>{this.error.set("Failed to load URLs."),this.isLoading.set(!1),console.error(i)}})}onAddUrl(){if(this.addUrlForm.invalid)return;let i=this.addUrlForm.value.originalUrl;this.urlApiService.createUrl(i).subscribe({next:e=>{this.urls.update(r=>[e,...r]),this.addUrlForm.reset()},error:e=>{e.status===409?this.toastr.error("This URL has already been shortened."):this.toastr.error("An error occurred."),console.error(e)}})}onDelete(i){confirm("Are you sure you want to delete this URL?")&&this.urlApiService.deleteUrl(i).subscribe({next:()=>{this.urls.update(e=>e.filter(r=>r.id!==i))},error:e=>{this.toastr.error("Failed to delete URL."),console.error(e)}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-urls-table"]],decls:9,vars:5,consts:[[1,"container","mx-auto","max-w-5xl","p-4","sm:p-6","lg:p-8","font-sans","text-gray-800"],[1,"text-4xl","font-bold","text-center","mb-8","text-slate-700"],[1,"bg-white","p-6","rounded-lg","shadow-md","mb-8"],[1,"my-8","border-gray-200"],[1,"text-center","text-gray-500","py-12"],[1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded-lg","text-center"],[1,"bg-white","shadow-md","rounded-lg","overflow-hidden"],[1,"text-2xl","font-semibold","mb-4","text-slate-600"],[1,"flex","flex-col","sm:flex-row","items-center","gap-4",3,"ngSubmit","formGroup"],["type","text","formControlName","originalUrl","placeholder","Enter your URL",1,"flex-grow","w-full","p-3","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","transition"],["type","submit",1,"w-full","sm:w-auto","bg-indigo-600","text-white","px-6","py-3","rounded-md","font-semibold","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:bg-gray-400","disabled:cursor-not-allowed","transition",3,"disabled"],[1,"w-full","text-left","border-collapse"],[1,"bg-gray-100"],[1,"p-4","font-semibold","text-sm","uppercase","text-gray-600"],[1,"divide-y","divide-gray-200"],[1,"hover:bg-gray-50","transition"],[1,"p-4","max-w-xs","truncate"],[1,"text-indigo-600","hover:text-indigo-800","hover:underline",3,"routerLink","title"],[1,"p-4","whitespace-nowrap"],["target","_blank",1,"text-indigo-600","hover:text-indigo-800","hover:underline",3,"href"],[1,"p-4","text-gray-600"],[1,"bg-red-500","text-white","px-3","py-1","rounded","text-sm","font-medium","hover:bg-red-600","transition"],[1,"bg-red-500","text-white","px-3","py-1","rounded","text-sm","font-medium","hover:bg-red-600","transition",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h1",1),a(2," URL Shortener "),o(),s(3,H,7,2,"div",2),b(4,"hr",3),s(5,J,2,0,"p",4),s(6,K,2,1,"p",5),s(7,X,15,0,"div",6),s(8,Y,2,0,"p",4),o()),e&2&&(l(3),m(r.authService.isAuthenticated()?3:-1),l(2),m(r.isLoading()?5:-1),l(),m(r.error()?6:-1),l(),m(!r.isLoading()&&r.urls().length>0?7:-1),l(),m(!r.isLoading()&&r.urls().length===0?8:-1))},dependencies:[E,B,D,N,V,k,G,M,A,F],encapsulation:2})};export{j as UrlsTableComponent};
